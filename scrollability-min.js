(function(){var kLockThreshold=10;var kTouchMultiplier=1;var kMaxVelocity=720/devicePixelRatio;var kDecelRate=350;var kBounceLimit=0.5;var kBounceDecelRate=300;var kBounceTime=90;var kPageLimit=0.05;var kPageEscapeVelocity=50;var kScrollbarMargin=2;var isTouchSupported="ontouchstart"in window;var startEventName=isTouchSupported?'touchstart':'mousedown';var moveEventName=isTouchSupported?'touchmove':'mousemove';var endEventName=isTouchSupported?'touchend':'mouseup';var startX,startY,touchX,touchY,touchDown,touchMoved;var animationInterval=0;var touchTargets=[];var scrollers={'horizontal':createXTarget,'vertical':createYTarget};function onTouchStart(event){event.preventDefault();var touched=null;var touchCandidate=event.target;var holdTimeout=setTimeout(function(){holdTimeout=0;touched=setTouched(touchCandidate);},50);stopAnimation();var touch=isTouchSupported?event.touches[0]:event;touchX=startX=isTouchSupported?touch.clientX:touch.pageX;touchY=startY=isTouchSupported?touch.clientY:touch.pageY;touchDown=true;touchMoved=false;touchTargets=[];var startTime=new Date().getTime();var candidates=getTouchTargets(event.target);if(candidates.length){for(var i=0;i<candidates.length;++i){var target=createTarget(candidates[i],touchX,touchY,startTime);if(target){touchTargets.push(target);}}animationInterval=setInterval(touchAnimation,0);}var d=document;d.addEventListener(moveEventName,onTouchMove,false);d.addEventListener(endEventName,onTouchEnd,false);function onTouchMove(event){event.preventDefault();touchMoved=true;if(holdTimeout){clearTimeout(holdTimeout);holdTimeout=0;}if(touched){releaseTouched(touched);touched=null;}var touch=isTouchSupported?event.touches[0]:event;touchX=isTouchSupported?touch.clientX:touch.pageX;touchY=isTouchSupported?touch.clientY:touch.pageY;if(touchTargets.length>1){for(var i=0;i<touchTargets.length;++i){var target=touchTargets[i];if(target.disable&&target.disable(touchX,touchY,startX,startY)){target.terminator();touchTargets.splice(i,1);break;}}}}function onTouchEnd(event){if(holdTimeout){clearTimeout(holdTimeout);holdTimeout=0;}if(touched){var evt=document.createEvent('MouseEvents');evt.initMouseEvent('click',true,true,window,1);touched[0].dispatchEvent(evt);releaseTouched(touched);}d.removeEventListener(moveEventName,onTouchMove,false);d.removeEventListener(endEventName,onTouchEnd,false);touchDown=false;}}function createTarget(target,startX,startY,startTime){var constrained=target.constrained;var paginated=target.paginated;var viewport=target.viewport||0;var scrollbar=target.scrollbar;var position=target.node[target.key];var min=target.min;var max=target.max;var absMin=min;var absMax=Math.round(max/viewport)*viewport;var velocity=0;var decelerating=0;var decelOrigin,decelDelta;var bounceLimit=target.bounce;var pageLimit=viewport*kPageLimit;var lastTouch=target.filter(startX,startY);var lastTime=startTime;var stillTime=0;var stillThreshold=20;var snapped=false;if(paginated){var xposition=Math.round(position/viewport)*viewport;min=max=Math.round(xposition+absMax);}if(scrollbar){target.node.parentNode.appendChild(scrollbar);}function animator(touch,time){var deltaTime=1/(time-lastTime);lastTime=time;var continues=true;if(touchDown){var delta=(touch-lastTouch)*kTouchMultiplier;if(!delta){if(!stillTime){stillTime=time;}if(time-stillTime<stillThreshold){return true;}}else{stillTime=0;}lastTouch=touch;velocity=delta/deltaTime;if(position>max&&constrained){var excess=position-max;velocity*=(1.0-excess/bounceLimit);}else if(position<min&&constrained){var excess=min-position;velocity*=(1.0-excess/bounceLimit);}}else{if(paginated&&!snapped){snapped=true;if(Math.abs(position-max)>pageLimit||Math.abs(velocity)>kPageEscapeVelocity){if(position>max){if(max!=absMax){max+=viewport;min+=viewport;}}else{if(min!=absMin){max-=viewport;min-=viewport;}}}}if(position>max&&constrained){if(velocity>0){var excess=position-max;var elasticity=(1.0-excess/bounceLimit);velocity=Math.max(velocity-kBounceDecelRate*deltaTime,0)*elasticity;decelerating=0;}else{if(!decelerating){decelOrigin=position;decelDelta=max-position;}position=easeOutExpo(decelerating,decelOrigin,decelDelta,kBounceTime);return update(position,++decelerating<=kBounceTime&&Math.floor(position)>max);}}else if(position<min&&constrained){if(velocity<0){var excess=min-position;var elasticity=(1.0-excess/bounceLimit);velocity=Math.min(velocity+kBounceDecelRate*deltaTime,0)*elasticity;decelerating=0;}else{if(!decelerating){decelOrigin=position;decelDelta=min-position;}position=easeOutExpo(decelerating,decelOrigin,decelDelta,kBounceTime);return update(position,++decelerating<=kBounceTime&&Math.ceil(position)<min);}}else{if(!decelerating){if(velocity<0&&velocity<-kMaxVelocity){velocity=-kMaxVelocity;}else if(velocity>0&&velocity>kMaxVelocity){velocity=kMaxVelocity;}decelOrigin=velocity;}velocity=easeOutExpo(decelerating,decelOrigin,-decelOrigin,kDecelRate);if(++decelerating>kDecelRate||Math.floor(velocity)==0){continues=false;}}}position+=velocity*deltaTime;return update(position,continues);}function update(pos,continues){position=pos;target.node[target.key]=position;target.update(target.node,position);var range=-min-max;if(scrollbar&&viewport<range){var viewable=viewport-kScrollbarMargin*2;var height=(viewable/range)*viewable;var scrollPosition=0;if(position>max){height=Math.max(height-(position-max),5);scrollPosition=0;}else if(position<min){height=Math.max(height-(min-position),5);scrollPosition=(viewable-height);}else{scrollPosition=Math.round((Math.abs(position)/range)*(viewable-height));}scrollPosition+=kScrollbarMargin;scrollbar.style.height=Math.round(height)+'px';moveElement(scrollbar,0,Math.round(scrollPosition));if(touchMoved){scrollbar.style.opacity='0.8';scrollbar.style.webkitTransition='none';}}return continues;}function terminator(){if(paginated){update(Math.round(position/viewport)*viewport);}else if(position>max&&constrained){update(max);}else if(position<min&&constrained){update(min);}if(scrollbar){scrollbar.style.opacity='0';scrollbar.style.webkitTransition='opacity 0.2s linear';}}return{filter:target.filter,disable:target.disable,animator:animator,terminator:terminator};}function touchAnimation(){var time=new Date().getTime();for(var i=0;i<touchTargets.length;++i){var target=touchTargets[i];var touch=target.filter(touchX,touchY);if(!target.animator(touch,time)){target.terminator();touchTargets.splice(i--,1);}}if(!touchTargets.length){stopAnimation();}}function getTouchTargets(node){var targets=[];while(node){if(node.nodeType==1){var classes=node.className.split(' ');if(classes.indexOf('scrollable')!=-1){var paginated=classes.indexOf('paginated')!=-1;for(var i=0;i<classes.length;++i){var name=classes[i];if(scrollers[name]){var target=scrollers[name](node);target.key='scrollable_'+name;target.paginated=paginated;if(!(target.key in node)){node[target.key]=target.initial?target.initial(node):0;}targets.push(target);}}if(classes.indexOf('exclusive')!=-1){break;}}}node=node.parentNode;}return targets;}function setTouched(target){var touched=[];for(var n=target;n;n=n.parentNode){if(n.nodeType==1){n.className=(n.className?n.className+' ':'')+'touched';touched.push(n);}}return touched;}function releaseTouched(touched){for(var i=0;i<touched.length;++i){var n=touched[i];n.className=n.className.replace('touched','');}}function stopAnimation(){if(animationInterval){clearInterval(animationInterval);animationInterval=0;for(var i=0;i<touchTargets.length;++i){var target=touchTargets[i];target.terminator();}touchTargets=[];}}function moveElement(element,x,y){element.style.webkitTransform='translate3d('+(x?(x+'px'):'0')+','+(y?(y+'px'):'0')+','+'0)';}function initScrollbar(element){if(!element.scrollableScrollbar){var scrollbar=element.scrollableScrollbar=document.createElement('div');scrollbar.className='scrollableScrollbar';scrollbar.style.cssText=['position: absolute','top: 0','right: 2px','width: 5px','min-height: 6px','background: #666','opacity: 0','-webkit-border-radius: 2px 3px','-webkit-transform: translate3d(0,0,0)','-webkit-transition: opacity 0.15s linear'].join(';');}return element.scrollableScrollbar;}function easeOutExpo(t,b,c,d){return(t==d)?b+c:c*(-Math.pow(2,-10*t/d)+1)+b;}function createXTarget(element){var parent=element.parentNode;return{node:element,min:-parent.scrollWidth+parent.offsetWidth,max:0,viewport:parent.offsetWidth,bounce:parent.offsetWidth*kBounceLimit,constrained:true,filter:function(x,y){return x;},disable:function(x,y,startX,startY){var dx=Math.abs(x-startX);var dy=Math.abs(y-startY);if(dy>dx&&dy>kLockThreshold){return true;}},update:function(element,position){moveElement(element,position,element.scrollable_vertical);}};}function createYTarget(element){var parent=element.parentNode;return{node:element,scrollbar:initScrollbar(element),min:-parent.scrollHeight+parent.offsetHeight,max:0,viewport:parent.offsetHeight,bounce:parent.offsetHeight*kBounceLimit,constrained:true,filter:function(x,y){return y;},disable:function(x,y,startX,startY){var dx=Math.abs(x-startX);var dy=Math.abs(y-startY);if(dx>dy&&dx>kLockThreshold){return true;}},update:function(element,position){moveElement(element,element.scrollable_horizontal,position);}};}document.addEventListener(startEventName,onTouchStart,false);})();var is={ie:navigator.appName=='Microsoft Internet Explorer',java:navigator.javaEnabled(),ns:navigator.appName=='Netscape',ua:navigator.userAgent.toLowerCase(),version:parseFloat(navigator.appVersion.substr(21))||parseFloat(navigator.appVersion),win:navigator.platform=='Win32'}is.mac=is.ua.indexOf('mac')>=0;if(is.ua.indexOf('opera')>=0){is.ie=is.ns=false;is.opera=true;}if(is.ua.indexOf('gecko')>=0){is.ie=is.ns=false;is.gecko=true;}